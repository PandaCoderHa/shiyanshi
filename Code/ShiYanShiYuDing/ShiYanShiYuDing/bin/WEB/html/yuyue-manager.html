<!DOCTYPE html>
<html lang="en" class="">

<head>
  <meta charset="utf-8" />
  <title>高校实验室预约系统</title>
  <meta name="description" content="" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <link rel="stylesheet" href="../libs/assets/animate.css/animate.css" type="text/css" />
  <link rel="stylesheet" href="../libs/assets/font-awesome/css/font-awesome.min.css" type="text/css" />
  <link rel="stylesheet" href="../libs/assets/simple-line-icons/css/simple-line-icons.css" type="text/css" />
  <link rel="stylesheet" href="../libs/jquery/bootstrap/dist/css/bootstrap.css" type="text/css" />

  <link rel="stylesheet" href="css/font.css" type="text/css" />
  <link rel="stylesheet" href="css/app.css" type="text/css" />
  <link rel="stylesheet" href="css/style.css" type="text/css" />


  <link href="css/site.css" rel="stylesheet" type="text/css" />
  <link href="css/detail.css" rel="stylesheet" type="text/css" />

</head>

<body>
  <header id="header" class="app-header navbar" role="menu">
    <!-- navbar header -->
    <div class="navbar-header bg-dark">
      <button class="pull-right visible-xs dk" ui-toggle-class="show" target=".navbar-collapse">
        <i class="glyphicon glyphicon-cog"></i>
      </button>
      <button class="pull-right visible-xs" ui-toggle-class="off-screen" target=".app-aside" ui-scroll="app">
        <i class="glyphicon glyphicon-align-justify"></i>
      </button>
      <!-- brand -->
      <a href="home.html" class="navbar-brand text-lt">

        <span class="hidden-folded m-l-xs">高校实验室预约系统</span>
      </a>
      <!-- / brand -->
    </div>





    <div class="collapse pos-rlt navbar-collapse box-shadow bg-white-only">



      <ul class="nav navbar-nav navbar-right">

        <li class="dropdown">
          <a href="#" data-toggle="dropdown" class="dropdown-toggle clear">
            <span class="thumb-sm avatar pull-right m-t-n-sm m-b-n-sm m-l-sm">
              <img src="img/b6.jpg" alt="...">
              <i class="on md b-white bottom"></i>
            </span>
            <span id="userName" class="hidden-sm hidden-md">胡司令</span>
            <b class="caret"></b>
          </a>
          <ul class="dropdown-menu animated fadeInRight w">
            <li>
              <a id="logout" ui-sref="access.signin">退出登录</a>
            </li>
          </ul>
          <!-- / dropdown -->
        </li>
      </ul>

      <ul class="nav navbar-nav navbar-right mr20">

        <li class="dropdown">
          <a href="#" data-toggle="dropdown" class="dropdown-toggle" aria-expanded="false">
            <i class="fa fa-fw fa-plus visible-xs-inline-block"></i>
            <span translate="header.navbar.new.NEW">管理员设置</span>
            <span class="caret"></span>
          </a>
          <ul id="manager" class="dropdown-menu" role="menu">
            <!-- <li>
              <a href="jiaoshi-manamer.html">实验室管理</a>
            </li>
            <li>
              <a href="javascript:">实验室座位管理</a>
            </li>
            <li>
              <a href="jiaoshi-set.html">实验室基础设定</a>
            </li> -->

          </ul>
        </li>

        <li class="dropdown">
          <a href="#" data-toggle="dropdown" class="dropdown-toggle" aria-expanded="false">
            <i class="fa fa-fw fa-plus visible-xs-inline-block"></i>
            <span translate="header.navbar.new.NEW">个人中心</span>
            <span class="caret"></span>
          </a>
          <ul class="dropdown-menu" role="menu">
            <li>
              <a href="yuyue-manager.html">预约管理</a>
            </li>
            <li>
              <a href="info-change.html">修改个人资料</a>
            </li>
          </ul>
        </li>

      </ul>



      <!-- / navbar right -->
    </div>
    <!-- / navbar collapse -->
  </header>

  <banner>
    <div class="banner-img"></div>
  </banner>

  <div class="app app-header-fixed ">
    <div class="g-in f-cb">

      <div class="g-sd-l">
        <div class="m-s-menu">
          <ul>
            <li class="learn">
              <span class="fa fa-th-list"></span> 实验室列表</li>
            <!-- <li>
              <a href="preview.html">第一实验室</a>
            </li>
            <li class="crt">
              <a href="preview.html">
                <span class="glyphicon glyphicon-play"></span>第二实验室</a>
            </li>
            <li>
              <a href="preview.html">第三实验室</a>
            </li>
            <li>
              <a href="preview.html">第四实验室</a>
            </li>
            <li>
              <a href="preview.html">第五实验室</a>
            </li> -->

          </ul>


        </div>
      </div>

      <div class="g-mncw w860">
        <form>



          <div class="m-school">

            <div class="panel panel-default m20">
              <div class="panel-heading">
                <div class="panel-heading-title">实验室预约管理</div>


              </div>

              <div class="table-responsive">
                <table class="table table-striped b-t b-light">
                  <thead>
                    <tr>
                      <th>预约对象</th>
                      <th>预约人</th>
                      <th>组成员</th>
                      <th>
                        时间
                        <!-- <select class="form-control new-yuyue">
                          <option>新预约纪录</option>
                          <option></option>
                        </select> -->
                      </th>
                      <th>状态</th>
                      <th style="width:80px;">操作</th>
                    </tr>
                  </thead>
                  <tbody id="yuyuetable">
                    <!-- <tr>
                      <td>第一实验室 02座位</td>
                      <td>张莹</td>
                      <td>个人预约</td>
                      <td>
                        <p>开始：10-10 15:30</p>
                        <p> 结束：10-10 16:00</p>
                      </td>
                      <td>
                        <span class="yuyue-success">预约成功</span>
                      </td>
                      <td>
                        <button type="button" class="btn w-xs btn-info">取消</button>
                      </td>
                    </tr>

                    <tr>
                      <td>第一实验室 03座位</td>
                      <td>张莹</td>
                      <td>个人预约</td>
                      <td>
                        <p>开始：10-12 15:30</p>
                        <p> 结束：10-12 16:00</p>
                      </td>
                      <td>
                        <span class="yuyue-success">已生效</span>
                      </td>
                      <td>
                        <button type="button" class="btn w-xs btn-info" data-toggle="modal" data-target="#myModal">提前结束</button>
                      </td>
                    </tr> -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>


  <!-- Modal -->
  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
          <h3 class="modal-title" id="myModalLabel">提前结束预约</h3>
        </div>
        <div class="modal-body">
          <div class="form-group-list">
            <label class="control-label">预约对象:</label>
            <div>
              第一实验室
            </div>
          </div>
          <div class="form-group-list">
            <label class="control-label">预约日期:</label>
            <div>
              2017-10-20
            </div>
          </div>
          <div class="form-group-list">
            <label class="control-label">开始时间:</label>
            <div>
              15:00
            </div>
          </div>
          <div class="form-group-list">
            <label class="control-label">结束时间:</label>
            <div>
              <select class="form-control">
                <option valuue="08:00">08:00</option>
                <option valuue="08:30">08:30</option>
                <option valuue="09:00">09:00</option>
                <option valuue="09:30">09:30</option>
                <option valuue="10:00">10:00</option>
                <option valuue="10:30">10:30</option>
                <option valuue="11:00">11:00</option>
                <option valuue="11:30">11:30</option>
                <option valuue="12:00">12:00</option>
                <option valuue="12:30">12:30</option>
                <option valuue="13:00">13:00</option>
                <option valuue="13:30">13:30</option>
                <option valuue="14:00">14:00</option>
                <option valuue="14:30">14:30</option>
                <option valuue="15:00">15:00</option>
                <option valuue="15:30">15:30</option>
                <option valuue="16:00">16:00</option>
                <option valuue="16:30">16:30</option>
                <option valuue="17:00">17:00</option>
                <option valuue="17:30">17:30</option>
                <option valuue="18:00">18:00</option>
                <option valuue="18:30">18:30</option>
                <option valuue="19:00">19:00</option>
                <option valuue="19:30">19:30</option>
                <option valuue="20:00">20:00</option>
                <option valuue="20:30">20:30</option>
                <option valuue="21:00">21:00</option>
                <option valuue="21:30">21:30</option>
                <option valuue="22:00">22:00</option>
              </select>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" >保存</button>
          <!-- <button type="button" class="btn btn-primary">退出</button> -->
        </div>
      </div>
    </div>
  </div>


  <script src="../libs/jquery/jquery/dist/jquery.js"></script>
  <script src="../libs/jquery/bootstrap/dist/js/bootstrap.js"></script>
  <script src="js/ui-load.js"></script>
  <script src="js/ui-jp.config.js"></script>
  <script src="js/ui-jp.js"></script>
  <script src="js/ui-nav.js"></script>
  <script src="js/ui-toggle.js"></script>
  <script src="js/ui-client.js"></script>

  <script src="js/jquery.bootstrap.newsbox.min.js" type="text/javascript"></script>

  <!-- Modal -->
  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
          <h3 class="modal-title" id="myModalLabel">提前结束预约</h3>
        </div>
        <div class="modal-body">

          <div class="form-group-list">
            <label class="control-label">预约对象:</label>
            <div>
              第一实验室
            </div>
          </div>
          <div class="form-group-list">
            <label class="control-label">预约日期:</label>
            <div>
              2017-10-20
            </div>
          </div>
          <div class="form-group-list">
            <label class="control-label">开始时间:</label>
            <div>
              15:00
            </div>
          </div>

          <div class="form-group-list">
            <label class="control-label">结束时间:</label>
            <div>
              <select class="form-control">
                <option valuue="08:00">08:00</option>
                <option valuue="08:30">08:30</option>
                <option valuue="09:00">09:00</option>
                <option valuue="09:30">09:30</option>
                <option valuue="10:00">10:00</option>
                <option valuue="10:30">10:30</option>
                <option valuue="11:00">11:00</option>
                <option valuue="11:30">11:30</option>
                <option valuue="12:00">12:00</option>
                <option valuue="12:30">12:30</option>
                <option valuue="13:00">13:00</option>
                <option valuue="13:30">13:30</option>
                <option valuue="14:00">14:00</option>
                <option valuue="14:30">14:30</option>
                <option valuue="15:00">15:00</option>
                <option valuue="15:30">15:30</option>
                <option valuue="16:00">16:00</option>
                <option valuue="16:30">16:30</option>
                <option valuue="17:00">17:00</option>
                <option valuue="17:30">17:30</option>
                <option valuue="18:00">18:00</option>
                <option valuue="18:30">18:30</option>
                <option valuue="19:00">19:00</option>
                <option valuue="19:30">19:30</option>
                <option valuue="20:00">20:00</option>
                <option valuue="20:30">20:30</option>
                <option valuue="21:00">21:00</option>
                <option valuue="21:30">21:30</option>
                <option valuue="22:00">22:00</option>
              </select>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">保存</button>
          <button type="button" class="btn btn-primary">退出</button>
        </div>
      </div>
    </div>
  </div>
  <script src="js/common.js" type="text/javascript"></script>
  <script>
    $(function () {
      getShiYanShis();
      getYuYue(loginuser.id, -1);
      setYuYueTable();

      var modal = $("#myModal");
      modal.on("show.bs.modal", function (e) {
        var id = $(e.relatedTarget).data("id");
        if (id) {
          var selectedS = ShiYanShiS.find(s => s.zidongbianhao == id);
          $("#M_id").val(id);
          $("#M_mingzi").val($.trim(selectedS.mingzi));
          $("input:radio[name='M_shifoshiyong']").eq(0).attr("checked", true);
          //$("input:radio[name='M_shifoshiyong']:checked")
        }
        else {
          $("#M_id").val('');
          $("#M_mingzi").val('');
          $("input:radio[name='M_shifoshiyong']").eq(0).attr("checked", true);
        }
      });
      modal.on('hide.bs.modal', function () {
        $("#M_id").val('');
        $("#M_mingzi").val('');
      });

    });

    function setYuYueTable() {
      setTimeout(function () {
        if (YuYueS) {
          //$('#mycalendar').dcalendar();
          var yyHtml = '';
          var now = new Date();
          YuYueS.forEach(function (y) {
            var kaishi = new Date(y.kaishi);
            var jieshu = new Date(y.jieshu);
            yyHtml += '<tr><td>' + $.trim(y.shiyanshiMing) + ' ' + $.trim(y.zuoweiMing) + '</td><td>' + loginuser.name + '</td><td>个人预约</td>' +
              '<td><p>开始：' + y.kaishi.substr(5, 11) + '</p><p> 结束：' + y.jieshu.substr(5, 11) + '</p></td>';
            if (kaishi > now) {
              yyHtml += '<td><span class="yuyue-success">预约成功</span></td>' +
                '<td><button type="button" onclick="deleteYuYue(' + y.zidongbianhao + ')" class="btn w-xs btn-info">取消</button></td></tr>';
            } else {
              if (jieshu < now) {
                yyHtml += '<td><span class="yuyue-success">已结束</span></td>' +
                  '<td></td></tr>';
              } else {
                yyHtml += '<td><span class="yuyue-success">已生效</span></td>' +
                  '<td><button type="button" class="btn w-xs btn-info" data-toggle="modal" data-target="#myModal">提前结束</button></td></tr>';
              }

            }

          }, this);

          $("#yuyuetable").html(yyHtml);
        } else {
          setYuYueTable();
        }
      }, 500);
    }

    function deleteYuYue(id) {
      if (id) {
        alert(id)
        // $.ajax({
        //   type: "delete",
        //   url: apiUrl + 'T_YuYue/' + id,
        //   success: function (response) {
        //   }
        // });
      }
    }

    function tiqianjieshu() {
      var id = $("#M_id").val();
      var zuowei = {
        zuoweimingcheng: $("#M_mingzi").val(),
        shifoutingyong: $("input:radio[name='M_shifoshiyong']:checked").val() ? false : true,
        zhuohao: $("#M_zhuohaoSelect").val(),
        gengxinriqi: new Date().toString().substr(0, 24)
      };
      // if (id) {
      //   $.ajax({
      //     type: "put",
      //     url: apiUrl + 'M_ZuoWei/' + id,
      //     data: zuowei,
      //     dataType: "json",
      //     success: function (response) {
      //       $('#myModal').modal('hide');
      //       getZuoWei();
      //     }
      //   });
      // } else {
      //   // $.post(apiUrl + 'M_ZuoWei/?shiyanshibianhao=' + $("#shiyanshiSelect").val(), zuowei,
      //   //     function (data, textStatus, jqXHR) {
      //   //         alert('保存成功！');
      //   //         $('#myModal').modal('hide');
      //   //         window.location.href = window.location.href;
      //   //     },
      //   //     "json"
      //   // );
      //   $.ajax({
      //     type: "post",
      //     url: apiUrl + 'M_ZuoWei/?shiyanshibianhao=' + $("#shiyanshiSelect").val(),
      //     data: zuowei,
      //     dataType: "json",
      //     complete: function () {
      //       $('#myModal').modal('hide');
      //       getZuoWei();
      //     }
      //   });
      // }
    }
  </script>



</body>

</html>